---
minutes: 5
translated_at: '2024-03-26T10:12:17.398Z'
---

# 类型转换

Rust 没有 _隐式的_ 类型转换，但支持使用 `as` 进行显式转换。这些转换通常遵循 C 语言的语义（在其定义的范围内）。

```rust,editable
fn main() {
    let value: i64 = 1000;
    println!("as u16: {}", value as u16);
    println!("as i16: {}", value as i16);
    println!("as u8: {}", value as u8);
}
```

`as` 的结果在 Rust 中 _总是_ 明确定义的，并且在不同平台上是一致的。这可能与你关于改变符号或者转换到更小类型的直觉不一致——请查阅文档，并添加注释以提高清晰度。

使用 `as` 进行类型转换是一个相对锋利的工具，很容易使用不当，而且随着未来维护工作中所使用的类型或类型中值的范围的变更，可能会成为微妙错误的来源。类型转换最好只在意图表明无条件截断时使用（例如，使用 `as u32` 选择 `u64` 的底部 32 位，不管高位中有什么）。

对于无可失败的类型转换（例如 `u32` 转 `u64`），相比 `as`，更推荐使用 `From` 或 `Into` 来确认转换实际上是无可失败的。对于可能失败的类型转换，当你想处理可能适合或可能不适合的类型转换时，`TryFrom` 和 `TryInto` 是可以使用的。

<details>

在这张幻灯片后考虑休息一下。

`as` 类似于 C++ 的静态类型转换。在可能丢失数据的情形下使用 `as` 通常不被鼓励，或者至少应加上解释性评论。

这在将整数转换为 `usize` 用作索引时很常见。

</details>
