---
translated_at: '2024-03-26T11:18:08.272Z'
---

## CXX 的局限性

到目前为止，使用 CXX 时最有用的页面是[类型参考][1]。

CXX 本质上适用于以下情况：

- 你的 Rust-C++ 接口足够简单，你可以声明所有内容。
- 你只使用 CXX 已经原生支持的类型，例如 `std::unique_ptr`、`std::string`、`&[u8]` 等。

它有许多限制 —— 例如缺乏对 Rust 的 `Option` 类型的支持。

这些限制使我们在 Chromium 中使用 Rust 仅限于良好隔离的“叶节点”，而不是用于任意 Rust-C++ 互操作。在考虑在 Chromium 中使用 Rust 的用例时，一个好的起点是草拟 CXX 绑定，以查看它是否看起来足够简单。

[1]: https://cxx.rs/bindings.html

<details>
此外，目前在一个组件中的 Rust 代码不能依赖另一个组件中的 Rust 代码，由于我们组件构建中的链接细节。这是将 Rust 限制用于叶节点的另一个原因。

你还应该讨论 CXX 的一些其他棘手点，例如：

- 它的错误处理是基于 C++ 异常的（在下一张幻灯片中给出）
- 函数指针使用起来很尴尬。

</details>
