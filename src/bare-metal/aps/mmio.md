---
translated_at: '2024-03-26T11:39:59.499Z'
---

# 针对 MMIO 的易失性内存访问

- 使用 `pointer::read_volatile` 和 `pointer::write_volatile`。
- 切勿保持引用。
- `addr_of!` 允许你获取结构体的字段而不创建中间引用。

<details>

- 易失性访问：读或写操作可能会产生副作用，因此防止编译器或硬件重新排序、复制或省略它们。
  - 通常，如果你先写后读，例如，通过一个可变引用，编译器可能会假设读取的值与刚写入的值相同，而不实际读取内存。
- 一些现有的用于硬件易失性访问的 crates 保持引用，但这是不健全的。只要存在引用，编译器可能选择对它进行解引用。
- 使用 `addr_of!` 宏从结构体指针获取结构体字段指针。

</details>
